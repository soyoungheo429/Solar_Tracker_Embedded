###############################################################################
#
# IAR ANSI C/C++ Compiler V8.22.1.15669/W32 for ARM       06/Nov/2025  19:34:51
# Copyright 1999-2018 IAR Systems AB.
#
#    Cpu mode     =  thumb
#    Endian       =  little
#    Source file  =  C:\Users\pnu6\Documents\week06\user\main.c
#    Command line =  
#        -f C:\Users\pnu6\AppData\Local\Temp\EW93B9.tmp
#        (C:\Users\pnu6\Documents\week06\user\main.c -D USE_STDPERIPH_DRIVER -D
#        STM32F10X_CL -lC C:\Users\pnu6\Documents\week06\Debug\List -o
#        C:\Users\pnu6\Documents\week06\Debug\Obj --no_cse --no_unroll
#        --no_inline --no_code_motion --no_tbaa --no_clustering --no_scheduling
#        --debug --endian=little --cpu=Cortex-M3 -e --fpu=None --dlib_config
#        "C:\Program Files (x86)\IAR Systems\Embedded Workbench
#        8.0\arm\INC\c\DLib_Config_Normal.h" -I
#        C:\Users\pnu6\Documents\week06\libraries\CMSIS\DeviceSupport\ -I
#        C:\Users\pnu6\Documents\week06\libraries\CMSIS\DeviceSupport\Startup\
#        -I
#        C:\Users\pnu6\Documents\week06\libraries\STM32F10x_StdPeriph_Driver_v3.5\inc\
#        -I
#        C:\Users\pnu6\Documents\week06\libraries\STM32F10x_StdPeriph_Driver_v3.5\src\
#        -I C:\Users\pnu6\Documents\week06\libraries\LCD\ -I
#        C:\Users\pnu6\Documents\week06\user\ -I
#        C:\Users\pnu6\Documents\week06\user\inc\ -Ol -I "C:\Program Files
#        (x86)\IAR Systems\Embedded Workbench 8.0\arm\CMSIS\Core\Include\" -I
#        "C:\Program Files (x86)\IAR Systems\Embedded Workbench
#        8.0\arm\CMSIS\DSP\Include\")
#    Locale       =  C
#    List file    =  C:\Users\pnu6\Documents\week06\Debug\List\main.lst
#    Object file  =  C:\Users\pnu6\Documents\week06\Debug\Obj\main.o
#
###############################################################################

C:\Users\pnu6\Documents\week06\user\main.c
      1          
      2          #include "stm32f10x_adc.h"
      3          #include "stm32f10x_rcc.h"
      4          #include "stm32f10x_gpio.h"
      5          #include "stm32f10x_usart.h"
      6          #include "misc.h"
      7          #include "lcd.h"
      8          #include "touch.h"
      9          
     10          #define LCD_TEAM_NAME_X 20
     11          #define LCD_TEAM_NAME_Y 50
     12          #define LCD_COORD_X_X	40
     13          #define LCD_COORD_X_Y	70
     14          #define LCD_COORD_Y_X	40
     15          #define LCD_COORD_Y_Y	90
     16          #define LCD_LUX_VAL_X	20
     17          #define LCD_LUX_VAL_Y	110
     18          
     19          void Init(void);
     20          void RccInit(void);
     21          void GpioInit(void);
     22          void AdcInit(void);
     23          void NvicInit(void);
     24          

   \                                 In section .rodata, align 4
     25          const int color[12] = {WHITE,CYAN,BLUE,RED,MAGENTA,LGRAY,GREEN,YELLOW,BROWN,BRRED,GRAY};
   \                     color:
   \   00000000   0x0000FFFF         DC32 65535, 32767, 31, 63488, 63519, 50712, 2016, 65504, 48192, 64519
   \              0x00007FFF   
   \              0x0000001F   
   \              0x0000F800   
   \              0x0000F81F   
   \              0x0000C618   
   \              0x000007E0   
   \              0x0000FFE0   
   \              0x0000BC40   
   \              0x0000FC07   
   \   00000028   0x00008430         DC32 33840
   \   0000002C   0x00 0x00          DC8 0, 0, 0, 0
   \              0x00 0x00    
     26          

   \                                 In section .bss, align 2
     27          uint16_t ADC_Value = 0;
   \                     ADC_Value:
   \   00000000                      DS8 2
     28          

   \                                 In section .text, align 2, keep-with-next
     29          int main(){
   \                     main: (+1)
   \   00000000   0xB5F8             PUSH     {R3-R7,LR}
     30          	uint16_t pos_x, pos_y;
     31          	uint16_t pix_x, pix_y;
     32          
     33          	Init();
   \   00000002   0x.... 0x....      BL       Init
     34          
     35              LCD_Clear(WHITE);
   \   00000006   0xF64F 0x70FF      MOVW     R0,#+65535
   \   0000000A   0x.... 0x....      BL       LCD_Clear
     36          
     37              // team name
     38              LCD_ShowString(LCD_TEAM_NAME_X,LCD_TEAM_NAME_Y, "THU_TEAM06", BLUE, WHITE);
   \   0000000E   0xF64F 0x70FF      MOVW     R0,#+65535
   \   00000012   0x9000             STR      R0,[SP, #+0]
   \   00000014   0x231F             MOVS     R3,#+31
   \   00000016   0x....             LDR.N    R2,??DataTable3
   \   00000018   0x2132             MOVS     R1,#+50
   \   0000001A   0x2014             MOVS     R0,#+20
   \   0000001C   0x.... 0x....      BL       LCD_ShowString
     39          
     40              while(1){
     41          		// Todo
     42                  // sensor value
     43          
     44              	// get touch coordinate
     45                  Touch_GetXY(&pos_x, &pos_y, 1);
   \                     ??main_0: (+1)
   \   00000020   0x2201             MOVS     R2,#+1
   \   00000022   0xA903             ADD      R1,SP,#+12
   \   00000024   0xF10D 0x000E      ADD      R0,SP,#+14
   \   00000028   0x.... 0x....      BL       Touch_GetXY
     46                  Convert_Pos(pos_x, pos_y, &pix_x, &pix_y);
   \   0000002C   0xAB02             ADD      R3,SP,#+8
   \   0000002E   0xF10D 0x020A      ADD      R2,SP,#+10
   \   00000032   0xF8BD 0x100C      LDRH     R1,[SP, #+12]
   \   00000036   0xF8BD 0x000E      LDRH     R0,[SP, #+14]
   \   0000003A   0x.... 0x....      BL       Convert_Pos
     47                  LCD_DrawCircle(pix_x, pix_y, 3);
   \   0000003E   0x2203             MOVS     R2,#+3
   \   00000040   0xF8BD 0x1008      LDRH     R1,[SP, #+8]
   \   00000044   0xF8BD 0x000A      LDRH     R0,[SP, #+10]
   \   00000048   0x.... 0x....      BL       LCD_DrawCircle
     48              	// show touch coordinate
     49                  LCD_ShowNum(LCD_LUX_VAL_X, LCD_LUX_VAL_Y, ADC_Value, 3, YELLOW, BLACK); //value
   \   0000004C   0x2000             MOVS     R0,#+0
   \   0000004E   0x9001             STR      R0,[SP, #+4]
   \   00000050   0xF64F 0x70E0      MOVW     R0,#+65504
   \   00000054   0x9000             STR      R0,[SP, #+0]
   \   00000056   0x2303             MOVS     R3,#+3
   \   00000058   0x....             LDR.N    R0,??DataTable3_1
   \   0000005A   0x8802             LDRH     R2,[R0, #+0]
   \   0000005C   0x216E             MOVS     R1,#+110
   \   0000005E   0x2014             MOVS     R0,#+20
   \   00000060   0x.... 0x....      BL       LCD_ShowNum
     50                  LCD_ShowNum(LCD_COORD_X_X, LCD_COORD_X_Y, pix_x, 3, YELLOW, BLACK);
   \   00000064   0x2000             MOVS     R0,#+0
   \   00000066   0x9001             STR      R0,[SP, #+4]
   \   00000068   0xF64F 0x70E0      MOVW     R0,#+65504
   \   0000006C   0x9000             STR      R0,[SP, #+0]
   \   0000006E   0x2303             MOVS     R3,#+3
   \   00000070   0xF8BD 0x200A      LDRH     R2,[SP, #+10]
   \   00000074   0x2146             MOVS     R1,#+70
   \   00000076   0x2028             MOVS     R0,#+40
   \   00000078   0x.... 0x....      BL       LCD_ShowNum
     51                  LCD_ShowNum(LCD_COORD_Y_X, LCD_COORD_Y_Y, pix_y, 3, YELLOW, BLACK);
   \   0000007C   0x2000             MOVS     R0,#+0
   \   0000007E   0x9001             STR      R0,[SP, #+4]
   \   00000080   0xF64F 0x70E0      MOVW     R0,#+65504
   \   00000084   0x9000             STR      R0,[SP, #+0]
   \   00000086   0x2303             MOVS     R3,#+3
   \   00000088   0xF8BD 0x2008      LDRH     R2,[SP, #+8]
   \   0000008C   0x215A             MOVS     R1,#+90
   \   0000008E   0x2028             MOVS     R0,#+40
   \   00000090   0x.... 0x....      BL       LCD_ShowNum
   \   00000094   0xE7C4             B.N      ??main_0
     52          		// Todo
     53          
     54              }
     55          }
     56          

   \                                 In section .text, align 2, keep-with-next
     57          void Init(void) {
   \                     Init: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
     58          	SystemInit();
   \   00000002   0x.... 0x....      BL       SystemInit
     59          	RccInit();
   \   00000006   0x.... 0x....      BL       RccInit
     60          	GpioInit();
   \   0000000A   0x.... 0x....      BL       GpioInit
     61          	AdcInit();
   \   0000000E   0x.... 0x....      BL       AdcInit
     62          	NvicInit();
   \   00000012   0x.... 0x....      BL       NvicInit
     63          
     64          	LCD_Init();
   \   00000016   0x.... 0x....      BL       LCD_Init
     65          	Touch_Configuration();
   \   0000001A   0x.... 0x....      BL       Touch_Configuration
     66          	Touch_Adjust();
   \   0000001E   0x.... 0x....      BL       Touch_Adjust
     67          }
   \   00000022   0xBD01             POP      {R0,PC}          ;; return
     68          

   \                                 In section .text, align 2, keep-with-next
     69          void RccInit(void) {
   \                     RccInit: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
     70              RCC_APB2PeriphClockCmd(RCC_APB2Periph_ADC1, ENABLE);
   \   00000002   0x2101             MOVS     R1,#+1
   \   00000004   0xF44F 0x7000      MOV      R0,#+512
   \   00000008   0x.... 0x....      BL       RCC_APB2PeriphClockCmd
     71              RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOB, ENABLE);
   \   0000000C   0x2101             MOVS     R1,#+1
   \   0000000E   0x2008             MOVS     R0,#+8
   \   00000010   0x.... 0x....      BL       RCC_APB2PeriphClockCmd
     72          }
   \   00000014   0xBD01             POP      {R0,PC}          ;; return
     73          

   \                                 In section .text, align 2, keep-with-next
     74          void GpioInit(void) {
   \                     GpioInit: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
     75          	GPIO_InitTypeDef GPIO_InitStructure;
     76          	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0;
   \   00000002   0x2001             MOVS     R0,#+1
   \   00000004   0xF8AD 0x0000      STRH     R0,[SP, #+0]
     77          	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AIN;
   \   00000008   0x2000             MOVS     R0,#+0
   \   0000000A   0xF88D 0x0003      STRB     R0,[SP, #+3]
     78          	GPIO_Init(GPIOB, &GPIO_InitStructure);
   \   0000000E   0x4669             MOV      R1,SP
   \   00000010   0x....             LDR.N    R0,??DataTable3_2  ;; 0x40010c00
   \   00000012   0x.... 0x....      BL       GPIO_Init
     79          }
   \   00000016   0xBD01             POP      {R0,PC}          ;; return
     80          

   \                                 In section .text, align 2, keep-with-next
     81          void AdcInit(void) {
   \                     AdcInit: (+1)
   \   00000000   0xB500             PUSH     {LR}
   \   00000002   0xB085             SUB      SP,SP,#+20
     82              ADC_InitTypeDef ADC_InitStructure;
     83          
     84              // Todo: ADC1 Configuration
     85              ADC_InitStructure.ADC_Mode = ADC_Mode_Independent;
   \   00000004   0x2000             MOVS     R0,#+0
   \   00000006   0x9000             STR      R0,[SP, #+0]
     86              ADC_InitStructure.ADC_ScanConvMode = DISABLE;
   \   00000008   0x2000             MOVS     R0,#+0
   \   0000000A   0xF88D 0x0004      STRB     R0,[SP, #+4]
     87              ADC_InitStructure.ADC_ContinuousConvMode = ENABLE;
   \   0000000E   0x2001             MOVS     R0,#+1
   \   00000010   0xF88D 0x0005      STRB     R0,[SP, #+5]
     88              ADC_InitStructure.ADC_ExternalTrigConv = ADC_ExternalTrigConv_None;
   \   00000014   0xF45F 0x2060      MOVS     R0,#+917504
   \   00000018   0x9002             STR      R0,[SP, #+8]
     89              ADC_InitStructure.ADC_DataAlign = ADC_DataAlign_Right;
   \   0000001A   0x2000             MOVS     R0,#+0
   \   0000001C   0x9003             STR      R0,[SP, #+12]
     90              ADC_InitStructure.ADC_NbrOfChannel = 1;
   \   0000001E   0x2001             MOVS     R0,#+1
   \   00000020   0xF88D 0x0010      STRB     R0,[SP, #+16]
     91          	
     92              ADC_Init(ADC1, &ADC_InitStructure);
   \   00000024   0x4669             MOV      R1,SP
   \   00000026   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40012400
   \   00000028   0x.... 0x....      BL       ADC_Init
     93          	// Todo
     94          
     95              ADC_RegularChannelConfig(ADC1, ADC_Channel_8, 1, ADC_SampleTime_239Cycles5);
   \   0000002C   0x2307             MOVS     R3,#+7
   \   0000002E   0x2201             MOVS     R2,#+1
   \   00000030   0x2108             MOVS     R1,#+8
   \   00000032   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40012400
   \   00000034   0x.... 0x....      BL       ADC_RegularChannelConfig
     96              ADC_ITConfig(ADC1, ADC_IT_EOC, ENABLE); // interrupt enable
   \   00000038   0x2201             MOVS     R2,#+1
   \   0000003A   0xF44F 0x7108      MOV      R1,#+544
   \   0000003E   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40012400
   \   00000040   0x.... 0x....      BL       ADC_ITConfig
     97              ADC_Cmd(ADC1, ENABLE); // ADC1 enable
   \   00000044   0x2101             MOVS     R1,#+1
   \   00000046   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40012400
   \   00000048   0x.... 0x....      BL       ADC_Cmd
     98              ADC_ResetCalibration(ADC1);
   \   0000004C   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40012400
   \   0000004E   0x.... 0x....      BL       ADC_ResetCalibration
     99          
    100          	while(ADC_GetResetCalibrationStatus(ADC1));
   \                     ??AdcInit_0: (+1)
   \   00000052   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40012400
   \   00000054   0x.... 0x....      BL       ADC_GetResetCalibrationStatus
   \   00000058   0x2800             CMP      R0,#+0
   \   0000005A   0xD1FA             BNE.N    ??AdcInit_0
    101          
    102          	ADC_StartCalibration(ADC1);
   \   0000005C   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40012400
   \   0000005E   0x.... 0x....      BL       ADC_StartCalibration
    103          
    104          	while(ADC_GetCalibrationStatus(ADC1));
   \                     ??AdcInit_1: (+1)
   \   00000062   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40012400
   \   00000064   0x.... 0x....      BL       ADC_GetCalibrationStatus
   \   00000068   0x2800             CMP      R0,#+0
   \   0000006A   0xD1FA             BNE.N    ??AdcInit_1
    105          
    106              ADC_SoftwareStartConvCmd(ADC1, ENABLE);
   \   0000006C   0x2101             MOVS     R1,#+1
   \   0000006E   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40012400
   \   00000070   0x.... 0x....      BL       ADC_SoftwareStartConvCmd
    107          }
   \   00000074   0xB005             ADD      SP,SP,#+20
   \   00000076   0xBD00             POP      {PC}             ;; return
    108          

   \                                 In section .text, align 2, keep-with-next
    109          void NvicInit(void){
   \                     NvicInit: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
    110              NVIC_InitTypeDef NVIC_InitStructure;
    111          
    112              NVIC_InitStructure.NVIC_IRQChannel = ADC1_2_IRQn;
   \   00000002   0x2012             MOVS     R0,#+18
   \   00000004   0xF88D 0x0000      STRB     R0,[SP, #+0]
    113              NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;
   \   00000008   0x2000             MOVS     R0,#+0
   \   0000000A   0xF88D 0x0001      STRB     R0,[SP, #+1]
    114              NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;
   \   0000000E   0x2000             MOVS     R0,#+0
   \   00000010   0xF88D 0x0002      STRB     R0,[SP, #+2]
    115              NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
   \   00000014   0x2001             MOVS     R0,#+1
   \   00000016   0xF88D 0x0003      STRB     R0,[SP, #+3]
    116              NVIC_Init(&NVIC_InitStructure);
   \   0000001A   0x4668             MOV      R0,SP
   \   0000001C   0x.... 0x....      BL       NVIC_Init
    117          }
   \   00000020   0xBD01             POP      {R0,PC}          ;; return
    118          
    119          
    120          /*
    121           * ISR
    122           */
    123          

   \                                 In section .text, align 2, keep-with-next
    124          void ADC1_2_IRQHandler() {
   \                     ADC1_2_IRQHandler: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
    125          	if (ADC_GetITStatus(ADC1, ADC_IT_EOC) != RESET) {
   \   00000002   0xF44F 0x7108      MOV      R1,#+544
   \   00000006   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40012400
   \   00000008   0x.... 0x....      BL       ADC_GetITStatus
   \   0000000C   0x2800             CMP      R0,#+0
   \   0000000E   0xD009             BEQ.N    ??ADC1_2_IRQHandler_0
    126          		ADC_Value = ADC_GetConversionValue(ADC1);
   \   00000010   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40012400
   \   00000012   0x.... 0x....      BL       ADC_GetConversionValue
   \   00000016   0x....             LDR.N    R1,??DataTable3_1
   \   00000018   0x8008             STRH     R0,[R1, #+0]
    127          		//--- Clear ADC1 AWD pending interrupt bit
    128          		ADC_ClearITPendingBit(ADC1, ADC_IT_EOC);
   \   0000001A   0xF44F 0x7108      MOV      R1,#+544
   \   0000001E   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40012400
   \   00000020   0x.... 0x....      BL       ADC_ClearITPendingBit
    129          	}
    130          }
   \                     ??ADC1_2_IRQHandler_0: (+1)
   \   00000024   0xBD01             POP      {R0,PC}          ;; return

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3:
   \   00000000   0x........         DC32     ?_0

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3_1:
   \   00000000   0x........         DC32     ADC_Value

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3_2:
   \   00000000   0x40010C00         DC32     0x40010c00

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3_3:
   \   00000000   0x40012400         DC32     0x40012400

   \                                 In section .rodata, align 4
   \                     ?_0:
   \   00000000   0x54 0x48          DC8 "THU_TEAM06"
   \              0x55 0x5F    
   \              0x54 0x45    
   \              0x41 0x4D    
   \              0x30 0x36    
   \              0x00         
   \   0000000B   0x00               DC8 0

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       8   ADC1_2_IRQHandler
         8   -> ADC_ClearITPendingBit
         8   -> ADC_GetConversionValue
         8   -> ADC_GetITStatus
      24   AdcInit
        24   -> ADC_Cmd
        24   -> ADC_GetCalibrationStatus
        24   -> ADC_GetResetCalibrationStatus
        24   -> ADC_ITConfig
        24   -> ADC_Init
        24   -> ADC_RegularChannelConfig
        24   -> ADC_ResetCalibration
        24   -> ADC_SoftwareStartConvCmd
        24   -> ADC_StartCalibration
       8   GpioInit
         8   -> GPIO_Init
       8   Init
         8   -> AdcInit
         8   -> GpioInit
         8   -> LCD_Init
         8   -> NvicInit
         8   -> RccInit
         8   -> SystemInit
         8   -> Touch_Adjust
         8   -> Touch_Configuration
       8   NvicInit
         8   -> NVIC_Init
       8   RccInit
         8   -> RCC_APB2PeriphClockCmd
      24   main
        24   -> Convert_Pos
        24   -> Init
        24   -> LCD_Clear
        24   -> LCD_DrawCircle
        24   -> LCD_ShowNum
        24   -> LCD_ShowString
        24   -> Touch_GetXY


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable3
       4  ??DataTable3_1
       4  ??DataTable3_2
       4  ??DataTable3_3
      12  ?_0
      38  ADC1_2_IRQHandler
       2  ADC_Value
     120  AdcInit
      24  GpioInit
      36  Init
      34  NvicInit
      22  RccInit
      48  color
     150  main

 
   2 bytes in section .bss
  60 bytes in section .rodata
 440 bytes in section .text
 
 440 bytes of CODE  memory
  60 bytes of CONST memory
   2 bytes of DATA  memory

Errors: none
Warnings: none
